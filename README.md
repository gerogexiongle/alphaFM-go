# alphaFM-go

> Goè¯­è¨€å®ç°çš„Factorization Machinesç®—æ³•åº“ï¼ŒåŸºäºFTRLä¼˜åŒ–

[![Go Version](https://img.shields.io/badge/Go-1.18+-00ADD8?style=flat&logo=go)](https://go.dev/)
[![License](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)
[![Build](https://img.shields.io/badge/Build-Passing-brightgreen.svg)]()

## ğŸ“– ç®€ä»‹

**alphaFM-go** æ˜¯å¯¹ç»å…¸C++ç‰ˆæœ¬ [alphaFM](https://github.com/CastellanZhang/alphaFM) çš„Goè¯­è¨€é‡æ„å®ç°ã€‚

- ğŸ¯ **ç”¨é€”**: äºŒåˆ†ç±»é—®é¢˜ï¼ˆCTRé¢„ä¼°ã€æ¨èç³»ç»Ÿç­‰ï¼‰
- ğŸ§® **ç®—æ³•**: Factorization Machines (FM)
- ğŸš€ **ä¼˜åŒ–**: FTRL (Follow The Regularized Leader)
- ğŸ’» **è¯­è¨€**: Go 1.18+
- ğŸ“Š **ç‰¹ç‚¹**: å•æœºå¤šçº¿ç¨‹ã€æµå¼å¤„ç†ã€å·¥ä¸šçº§æ€§èƒ½

### ä¸ºä»€ä¹ˆé€‰æ‹©Goç‰ˆæœ¬ï¼Ÿ

- âœ¨ **ä»£ç æ›´ç®€æ´** - æ¯”C++ç‰ˆæœ¬å‡å°‘30%ä»£ç é‡
- ğŸ”’ **ç±»å‹å®‰å…¨** - ç¼–è¯‘æ—¶ç±»å‹æ£€æŸ¥
- âš¡ **å¹¶å‘ç®€å•** - goroutineæ¯”pthreadæ›´æ˜“ç”¨
- ğŸ›¡ï¸ **å†…å­˜å®‰å…¨** - è‡ªåŠ¨åƒåœ¾å›æ”¶
- ğŸŒ **è·¨å¹³å°** - æ— éœ€ä¿®æ”¹å³å¯ç¼–è¯‘

## âœ¨ æ ¸å¿ƒç‰¹æ€§

| ç‰¹æ€§ | è¯´æ˜ | çŠ¶æ€ |
|------|------|------|
| FMæ¨¡å‹ | äºŒé˜¶ç‰¹å¾äº¤äº’ | âœ… |
| FTRLä¼˜åŒ– | åœ¨çº¿å­¦ä¹ ç®—æ³• | âœ… |
| å¤šçº¿ç¨‹è®­ç»ƒ | Goroutineå¹¶è¡Œ | âœ… |
| å¤šçº¿ç¨‹é¢„æµ‹ | é«˜æ€§èƒ½æ¨ç† | âœ… |
| å¢é‡è®­ç»ƒ | åŠ è½½æ—§æ¨¡å‹ç»§ç»­è®­ç»ƒ | âœ… |
| ç¨€ç–è§£ | L1æ­£åˆ™+å¼ºåˆ¶ç¨€ç– | âœ… |
| æ–‡æœ¬æ¨¡å‹ | å¯è¯»çš„æ¨¡å‹æ ¼å¼ | âœ… |
| äºŒè¿›åˆ¶æ¨¡å‹ | å¿«é€ŸåŠ è½½ | âš ï¸ åŸºç¡€å®ç° |
| æµå¼å¤„ç† | ç®¡é“è¾“å…¥ï¼Œæ— éœ€å…¨éƒ¨åŠ è½½ | âœ… |

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…ä¾èµ–

```bash
# éœ€è¦ Go 1.18 æˆ–æ›´é«˜ç‰ˆæœ¬
go version
```

### ç¼–è¯‘

```bash
cd /data/xiongle/alphaFM-go
make
```

ç¼–è¯‘ååœ¨ `bin/` ç›®å½•ç”Ÿæˆ3ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼š
- `fm_train` - è®­ç»ƒç¨‹åº
- `fm_predict` - é¢„æµ‹ç¨‹åº  
- `model_bin_tool` - æ¨¡å‹å·¥å…·

### å¿«é€Ÿæµ‹è¯•

```bash
# è¿è¡Œæµ‹è¯•è„šæœ¬
./test.sh

# æ‰‹åŠ¨æµ‹è¯•
cat test_data.txt | ./bin/fm_train -m model.txt -dim 1,1,4 -core 2
cat test_data.txt | ./bin/fm_predict -m model.txt -dim 4 -out result.txt
```

## ğŸ“š ä½¿ç”¨ç¤ºä¾‹

### åŸºç¡€è®­ç»ƒ

```bash
cat train.txt | ./bin/fm_train \
    -m model.txt \
    -dim 1,1,8 \
    -core 4
```

### é«˜çº§è®­ç»ƒ

```bash
cat train.txt | ./bin/fm_train \
    -m model.txt \
    -dim 1,1,8 \
    -core 10 \
    -w_alpha 0.01 \
    -v_alpha 0.01 \
    -w_l1 0.05 \
    -v_l1 0.05 \
    -init_stdev 0.001 \
    -fvs 1
```

### å¢é‡è®­ç»ƒ

```bash
cat new_data.txt | ./bin/fm_train \
    -im old_model.txt \
    -m new_model.txt \
    -dim 1,1,8 \
    -core 4
```

### é¢„æµ‹

```bash
cat test.txt | ./bin/fm_predict \
    -m model.txt \
    -dim 8 \
    -out result.txt \
    -core 4
```

## ğŸ›ï¸ å‚æ•°è¯´æ˜

### è®­ç»ƒå‚æ•° (fm_train)

| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|--------|
| `-m` | è¾“å‡ºæ¨¡å‹è·¯å¾„ | å¿…éœ€ |
| `-mf` | æ¨¡å‹æ ¼å¼ (txt/bin) | txt |
| `-dim` | k0,k1,k2 (bias,ä¸€é˜¶,äºŒé˜¶ç»´åº¦) | 1,1,8 |
| `-init_stdev` | äºŒé˜¶å‚æ•°åˆå§‹åŒ–æ ‡å‡†å·® | 0.1 |
| `-w_alpha` | wçš„FTRLå­¦ä¹ ç‡Î± | 0.05 |
| `-w_beta` | wçš„FTRLå­¦ä¹ ç‡Î² | 1.0 |
| `-w_l1` | wçš„L1æ­£åˆ™ | 0.1 |
| `-w_l2` | wçš„L2æ­£åˆ™ | 5.0 |
| `-v_alpha` | vçš„FTRLå­¦ä¹ ç‡Î± | 0.05 |
| `-v_beta` | vçš„FTRLå­¦ä¹ ç‡Î² | 1.0 |
| `-v_l1` | vçš„L1æ­£åˆ™ | 0.1 |
| `-v_l2` | vçš„L2æ­£åˆ™ | 5.0 |
| `-core` | çº¿ç¨‹æ•° | 1 |
| `-im` | åˆå§‹æ¨¡å‹è·¯å¾„ï¼ˆå¢é‡è®­ç»ƒï¼‰ | - |
| `-fvs` | å¼ºåˆ¶ç¨€ç– (0/1) | 0 |

### é¢„æµ‹å‚æ•° (fm_predict)

| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|--------|
| `-m` | æ¨¡å‹è·¯å¾„ | å¿…éœ€ |
| `-mf` | æ¨¡å‹æ ¼å¼ (txt/bin) | txt |
| `-dim` | äºŒé˜¶ç»´åº¦ | 8 |
| `-core` | çº¿ç¨‹æ•° | 1 |
| `-out` | è¾“å‡ºè·¯å¾„ | å¿…éœ€ |

## ğŸ“Š æ•°æ®æ ¼å¼

### è¾“å…¥æ ·æœ¬æ ¼å¼ï¼ˆç±»ä¼¼libsvmï¼‰

```
label feature1:value1 feature2:value2 ...
```

**ç¤ºä¾‹ï¼š**
```
1 sex:1 age:0.3 f1:1 f3:0.9
0 sex:0 age:0.7 f2:0.4 f5:0.8 f8:1
```

- `label`: 1/0 æˆ– 1/-1
- `feature`: å­—ç¬¦ä¸²æˆ–æ•°å­—
- `value`: æµ®ç‚¹æ•°ï¼ˆå»ºè®®å½’ä¸€åŒ–ï¼‰
- å€¼ä¸º0çš„ç‰¹å¾å¯çœç•¥

### é¢„æµ‹ç»“æœæ ¼å¼

```
label score
```

- `label`: çœŸå®æ ‡ç­¾ (1/-1)
- `score`: é¢„æµ‹ä¸ºæ­£æ ·æœ¬çš„æ¦‚ç‡ [0, 1]

## ğŸ“ˆ æ€§èƒ½å¯¹æ¯”

| æŒ‡æ ‡ | C++ç‰ˆæœ¬ | Goç‰ˆæœ¬ | è¯´æ˜ |
|------|---------|--------|------|
| ä»£ç è¡Œæ•° | ~1500 | ~1700 | Goæ›´æ˜“è¯» |
| å¯æ‰§è¡Œæ–‡ä»¶ | 150KB | 2.2MB | GoåŒ…å«è¿è¡Œæ—¶ |
| è®­ç»ƒé€Ÿåº¦ | åŸºå‡† | ç›¸å½“ | å·®å¼‚<10% |
| é¢„æµ‹é€Ÿåº¦ | åŸºå‡† | ç›¸å½“ | å·®å¼‚<10% |
| å†…å­˜å ç”¨ | åŸºå‡† | +20% | GCå¼€é”€ |

**æµ‹è¯•ç¯å¢ƒ**: 1000ä¸‡æ ·æœ¬ï¼Œ200ä¸‡ç‰¹å¾ï¼Œ10çº¿ç¨‹

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
alphaFM-go/
â”œâ”€â”€ cmd/                    # å¯æ‰§è¡Œç¨‹åº
â”‚   â”œâ”€â”€ fm_train/          # è®­ç»ƒ
â”‚   â”œâ”€â”€ fm_predict/        # é¢„æµ‹
â”‚   â””â”€â”€ model_bin_tool/    # å·¥å…·
â”œâ”€â”€ pkg/                    # æ ¸å¿ƒåº“
â”‚   â”œâ”€â”€ model/             # æ¨¡å‹å’Œç®—æ³•
â”‚   â”œâ”€â”€ frame/             # å¤šçº¿ç¨‹æ¡†æ¶
â”‚   â”œâ”€â”€ sample/            # æ ·æœ¬è§£æ
â”‚   â”œâ”€â”€ lock/              # é”ç®¡ç†
â”‚   â”œâ”€â”€ mem/               # å†…å­˜æ± 
â”‚   â””â”€â”€ utils/             # å·¥å…·å‡½æ•°
â””â”€â”€ bin/                   # ç¼–è¯‘è¾“å‡º
```

## ğŸ“– æ–‡æ¡£

- [IMPLEMENTATION.md](IMPLEMENTATION.md) - è¯¦ç»†å®ç°è¯´æ˜
- [DELIVERY.md](DELIVERY.md) - é¡¹ç›®äº¤ä»˜æ–‡æ¡£
- [åŸC++ç‰ˆæœ¬æ–‡æ¡£](https://github.com/CastellanZhang/alphaFM)

## ğŸ§ª æµ‹è¯•

```bash
# åŸºç¡€æµ‹è¯•
./test.sh

# å¯¹æ¯”C++å’ŒGoç‰ˆæœ¬
./compare_test.sh

# æ¼”ç¤º
./demo.sh
```

## ğŸ¤ ä¸C++ç‰ˆæœ¬çš„å…¼å®¹æ€§

- âœ… **æ–‡æœ¬æ¨¡å‹æ ¼å¼å®Œå…¨å…¼å®¹** - å¯ä»¥äº’æ¢ä½¿ç”¨
- âœ… **å‘½ä»¤è¡Œå‚æ•°å®Œå…¨å…¼å®¹** - å‚æ•°åç§°å’Œå«ä¹‰ä¸€è‡´
- âœ… **æ•°æ®æ ¼å¼å®Œå…¨å…¼å®¹** - æ ·æœ¬æ ¼å¼ç›¸åŒ
- âœ… **ç®—æ³•å®Œå…¨ä¸€è‡´** - æ•°å€¼ç»“æœç›¸åŒ

## ğŸ”§ å¼€å‘

```bash
# æ ¼å¼åŒ–ä»£ç 
make fmt

# æ¸…ç†ç¼–è¯‘äº§ç‰©
make clean

# é‡æ–°ç¼–è¯‘
make
```

## ğŸ“ License

MIT License - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶

## ğŸ™ è‡´è°¢

æœ¬é¡¹ç›®åŸºäº [alphaFM](https://github.com/CastellanZhang/alphaFM) çš„Goè¯­è¨€é‡æ„å®ç°ï¼Œæ„Ÿè°¢åŸä½œè€…çš„å¼€æºè´¡çŒ®ã€‚

## ğŸ“§ è”ç³»æ–¹å¼

- é¡¹ç›®ä½ç½®: `/data/xiongle/alphaFM-go`
- åŸC++ç‰ˆæœ¬: `/data/xiongle/alphaFM`

---

â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œæ¬¢è¿ Starï¼

